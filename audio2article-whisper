#!/bin/bash

# Whisper + Claude Code éŸ³å£°è¨˜äº‹åŒ–ãƒ„ãƒ¼ãƒ«
# ä½¿ç”¨æ–¹æ³•: ./audio2article-whisper [éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«]

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_PATH="$SCRIPT_DIR/venv"
TOOL_PATH="$SCRIPT_DIR/whisper_transcriber.py"

# ä»®æƒ³ç’°å¢ƒã®ç¢ºèª
if [ ! -d "$VENV_PATH" ]; then
    echo "âŒ ä»®æƒ³ç’°å¢ƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:"
    echo "   python3 -m venv venv"
    echo "   source venv/bin/activate"
    echo "   pip install -r requirements.txt"
    exit 1
fi

# ä»®æƒ³ç’°å¢ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
source "$VENV_PATH/bin/activate"

# ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œ
if [ "$#" -eq 0 ]; then
    echo "ğŸ™ï¸ Whisper + Claude Code éŸ³å£°è¨˜äº‹åŒ–ãƒ„ãƒ¼ãƒ«"
    echo "============================================="
    echo "ä½¿ç”¨æ–¹æ³•:"
    echo "  ./audio2article-whisper [éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«]"
    echo "  ã¾ãŸã¯éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—"
    echo ""
    python "$TOOL_PATH"
else
    python "$TOOL_PATH" "$1"
fi