#!/usr/bin/env python3
"""
è¨˜äº‹ç”Ÿæˆå°‚ç”¨ãƒ„ãƒ¼ãƒ«
æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆ â†’ èª­ã¿ã‚„ã™ã„è¨˜äº‹ç”Ÿæˆ â†’ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰
"""

import os
import sys
import argparse
import re
from pathlib import Path
import pyperclip

class ArticleGenerator:
    def __init__(self):
        self.sample_articles = self.load_sample_articles()

    def load_sample_articles(self):
        """æ–‡ä½“å­¦ç¿’ç”¨ã®ã‚µãƒ³ãƒ—ãƒ«è¨˜äº‹ï¼ˆå®Ÿéš›ã®noteè¨˜äº‹ã‚’å‚è€ƒï¼‰"""
        return {
            "lifestyle": """ãƒãƒŠãƒŸã§ã™ã€‚

ä»Šé€±ã¯å­ã©ã‚‚ãŒç†±ã‚’å‡ºã—ã€å¤«ã‚‚ä½“èª¿ã‚’å´©ã—ã€èª°ã‹ã—ã‚‰ã‚’è‡ªå®…ä¿è‚²ã—ã¦ã‚‹ã®ã§å®¶äº‹è‚²å…ã‚’ä¸€äººã§ã¾ã‚ã—ã¦ãŠã‚Šä»•äº‹ãŒãªã‹ãªã‹é€²ã¿ã¾ã›ã‚“â€¦ã€‚

ãã‚“ãªä¸­ã§ã‚‚ã€æ—¥ã€…ã®ç”Ÿæ´»ã®ä¸­ã§è€ƒãˆã‚‹ã“ã¨ãŒã‚ã£ãŸã®ã§ãŠè©±ã—ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

3äººã®å­ã©ã‚‚ã‚’è‚²ã¦ãªãŒã‚‰ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦åƒã„ã¦ã„ã‚‹ä¸­ã§ã€æ¯æ—¥ãŒè©¦è¡ŒéŒ¯èª¤ã®é€£ç¶šã§ã™ã€‚å®Œç’§ã«ã¯ã„ã‹ãªã„ã‘ã‚Œã©ã€ãã®ä¸­ã§å­¦ã¶ã“ã¨ã‚„æ°—ã¥ãã“ã¨ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚

ä»Šå›ã¯ã€ãã‚“ãªæ—¥å¸¸ã®ä¸­ã§æ„Ÿã˜ãŸã“ã¨ã«ã¤ã„ã¦çš†ã•ã‚“ã¨å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

---------------

æ¯æ—¥ã®ç”Ÿæ´»ã®ä¸­ã«ã¯ã€å°ã•ãªç™ºè¦‹ã‚„å­¦ã³ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚æ™‚ã«ã¯å¤§å¤‰ãªã“ã¨ã‚‚ã‚ã‚Šã¾ã™ãŒã€ãã†ã—ãŸçµŒé¨“ã‚‚å«ã‚ã¦æˆé•·ã«ã¤ãªãŒã£ã¦ã„ã‚‹ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚

å®Ÿéš›ã«ä½“é¨“ã—ã¦ã¿ã‚‹ã“ã¨ã§åˆã‚ã¦åˆ†ã‹ã‚‹ã“ã¨ã‚‚å¤šãã€æŒ‘æˆ¦ã™ã‚‹ã“ã¨ã®å¤§åˆ‡ã•ã‚’å®Ÿæ„Ÿã—ã¦ã„ã¾ã™ã€‚

å®Œç’§ã‚’æ±‚ã‚ã™ããšã€ãã®æ™‚ãã®æ™‚ã§ã§ãã‚‹ã“ã¨ã‚’ã‚„ã£ã¦ã„ãã€‚ãã‚“ãªå§¿å‹¢ã‚’å¤§åˆ‡ã«ã—ãªãŒã‚‰éã”ã—ã¦ã„ã¾ã™ã€‚

---------------

ä»Šå¾Œã‚‚ã“ã†ã—ãŸæ—¥ã€…ã®æ°—ã¥ãã‚’çš†ã•ã‚“ã¨å…±æœ‰ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚ä¸€ç·’ã«å­¦ã³åˆã„ãªãŒã‚‰æˆé•·ã—ã¦ã„ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

çš†ã•ã‚“ã‚‚ãœã²ã€æ—¥å¸¸ã®å°ã•ãªæ°—ã¥ãã‚„å·¥å¤«ã‚’å¤§åˆ‡ã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ãã†ã—ãŸç©ã¿é‡ã­ãŒã€ã‚ˆã‚Šè‰¯ã„ç”Ÿæ´»ã«ã¤ãªãŒã£ã¦ã„ãã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚""",
            
            "work": """ãƒãƒŠãƒŸã§ã™ã€‚

ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦åƒãä¸­ã§ã€æœ€è¿‘ç‰¹ã«æ„Ÿã˜ã¦ã„ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ã©ã‚“ãªã«ã‚¹ã‚­ãƒ«ã‚„å®Ÿç¸¾ãŒã‚ã£ã¦ã‚‚ã€ã€Œã“ã®äººã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹ã®ã€ãªã‚“ã ã‹ç–²ã‚Œã‚‹ãªâ€¦ã€ã¨æ€ã‚ã‚Œã¦ã—ã¾ã£ãŸã‚‰ã€ä»•äº‹ã«ã¤ãªãŒã‚‰ãªã„ã€‚ã“ã‚Œã£ã¦ã¨ã¦ã‚‚å¤§åˆ‡ãªã“ã¨ã ã¨æ€ã†ã‚“ã§ã™ã‚ˆã­ã€‚

ç§è‡ªèº«ã€ã€Œã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚³ã‚¹ãƒˆãŒé«˜ã„äººã¨ã¯ä»•äº‹ã‚’ã—ãªã„ã€ã¨æ±ºã‚ã¦ã„ã¾ã™ã€‚ãã‚Œã¯ç›¸æ‰‹ã‚’å¦å®šã—ã¦ã„ã‚‹ã®ã§ã¯ãªãã€è‡ªåˆ†ãŒæ¶ˆè€—ã—ãªã„ãŸã‚ã®è‡ªå·±é˜²è¡›ç­–ã§ã™ã€‚

ã‚‚ã¡ã‚ã‚“ã€ç§ã‚‚æ˜”ã‹ã‚‰ã§ãã¦ã„ãŸã‚ã‘ã§ã¯ãªãã€ãŸãã•ã‚“ã®å¤±æ•—ã¨åçœã‚’ç¹°ã‚Šè¿”ã—ã¦ã€ç›¸æ‰‹ã®ç«‹å ´ã‚’è€ƒãˆã‚‹ã“ã¨ã®å¤§åˆ‡ã•ã‚’å­¦ã‚“ã§ãã¾ã—ãŸã€‚

---------------

ã¤ã„æœ€è¿‘ã‚‚ã€PRæ¡ˆä»¶ã§ã¡ã‚‡ã£ã¨ã—ãŸåçœãŒã‚ã‚Šã¾ã—ãŸã€‚

ä¼æ¥­ã®æ–¹ã«ã€Œå¸Œæœ›ã®å•†å“ã¯ã©ã‚Œã§ã™ã‹ï¼Ÿã€ã¨èã‹ã‚Œã€å¸Œæœ›ã ã‘ã‚’ä¼ãˆã¦è¿”ä¿¡ã—ã¦ã—ã¾ã£ãŸã‚“ã§ã™ã€‚å½“ç„¶ã€ãã®æ¬¡ã¯ç™ºé€å…ˆã®ä½æ‰€ã‚’èã‹ã‚Œã‚‹ã«æ±ºã¾ã£ã¦ã„ã‚‹ã®ã«ã€ãã‚Œã‚’å…ˆå›ã‚Šã—ã¦ä¼ãˆãªã‹ã£ãŸã›ã„ã§ã€ãƒ¡ãƒ¼ãƒ«ã®ã‚„ã‚Šå–ã‚ŠãŒ1å¾€å¾©å¢—ãˆã¦ã—ã¾ã„ã¾ã—ãŸã€‚

æœ¬å½“ã«ã¡ã£ã¡ã‚ƒã„ã“ã¨ãªã‚“ã§ã™ã‘ã©ã€ã€Œç›¸æ‰‹ãŒæ¬¡ã«ã©ã†å‹•ãã‹ã€ã‚’è€ƒãˆã¦é…æ…®ã™ã‚‹ã ã‘ã§ã€ãŠäº’ã„ã®ä½œæ¥­åŠ¹ç‡ãŒæ ¼æ®µã«ä¸ŠãŒã‚‹ã‚“ã§ã™ã‚ˆã­ã€‚

ç§ãŒå¤§åˆ‡ã«ã—ã¦ã„ã‚‹ã®ã¯ã€ŒçŠ¶æ³ã®å ±å‘Šã€ã¨ã€Œå…·ä½“çš„ãªãŠé¡˜ã„ã€ã‚’ã‚»ãƒƒãƒˆã§ä¼ãˆã‚‹ã“ã¨ã€‚çŠ¶æ³ã«ã‚‚ã‚ˆã‚Šã¾ã™ãŒã€ãªã‚‹ã¹ãã“ã¡ã‚‰ã‹ã‚‰é¸æŠè‚¢ã‚’æç¤ºã—ã¦ã€å°‘ã—ã§ã‚‚ç›¸æ‰‹ãŒåˆ¤æ–­ã—ã‚„ã™ã„ã‚ˆã†ã«å¿ƒãŒã‘ã¦ã„ã¾ã™ã€‚

---------------

ç§ã‚‚ã¾ã ã¾ã å¤±æ•—ã°ã‹ã‚Šã§åçœã¯å¤šã„ã§ã™ã€‚ã§ã‚‚ã€ãã†ã—ãŸçµŒé¨“ã‚‚å«ã‚ã¦å­¦ã‚“ã§ã„ã‘ãŸã‚‰ã¨æ€ã„ã¾ã™ã€‚

ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã®åƒãæ–¹ã§ã¯ã€ã“ã†ã—ãŸã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒã¨ã¦ã‚‚é‡è¦ã ã¨æ—¥ã€…æ„Ÿã˜ã¦ã„ã¾ã™ã€‚çš†ã•ã‚“ã‚‚ã€ãŠäº’ã„ã«æ°—æŒã¡ã‚ˆãåƒã‘ã‚‹ã‚ˆã†ãªé–¢ä¿‚ä½œã‚Šã‚’å¤§åˆ‡ã«ã—ã¦ã„ã‘ãŸã‚‰ã„ã„ã§ã™ã­ã€‚""",
            
            "technology": """ãƒãƒŠãƒŸã§ã™ã€‚

ä»Šæ—¥ã¯ã€ŒAIã®æ¥­å‹™æ´»ç”¨ã€ã«ã¤ã„ã¦è€ƒãˆãŸã“ã¨ã‚’ãŠè©±ã—ã—ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚

ã€ŒAIãƒ–ãƒ¼ãƒ ã®ä¸­ã€æ¥­å‹™æ´»ç”¨ã¯3å‰²å¼·ã«ã¨ã©ã¾ã‚‹ã€ã¨ã„ã†ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¦‹ã¦ã€è‰²ã€…ã¨æ€ã†ã“ã¨ãŒã‚ã‚Šã¾ã—ãŸã€‚ç‰¹ã«ã€å¹´ä»£åˆ¥ã§è¦‹ã‚‹ã¨ã€Œ20ä»£ã®6å‰²ãŒæ´»ç”¨ã™ã‚‹ä¸€æ–¹ã€50ä»£ã¯ã‚ãšã‹3å‰²ã€ã¨ã„ã†çµæœã‚‚èˆˆå‘³æ·±ã„ã§ã™ã‚ˆã­ã€‚

ã•ã‚‰ã«é¢ç™½ã„ã¨æ„Ÿã˜ãŸã®ã¯ã€ã€Œç”ŸæˆAIã®ä½¿ç”¨é »åº¦ãŒé«˜ã„äººã»ã©ã€AIã«ã‚ˆã‚‹äººæã®ç½®ãæ›ãˆã«ä¸å®‰ã‚’æ„Ÿã˜ã¦ã„ã‚‹ã€ã¨ã„ã†çµæœã§ã™ã€‚

ã“ã‚Œã¯ä¸€è¦‹ã™ã‚‹ã¨æ„å¤–ã«æ€ãˆã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ã€ŒAIã®èƒ½åŠ›ã‚’ã‚ˆãçŸ¥ã£ã¦ã„ã‚‹ã‹ã‚‰ã“ãã€ãã®å¯èƒ½æ€§ã¨è„…å¨ã‚’ãƒªã‚¢ãƒ«ã«æ„Ÿã˜ã¦ã„ã‚‹ã€ã¨ã„ã†ã“ã¨ã®è¡¨ã‚Œãªã®ã ã¨æ€ã„ã¾ã™ã€‚

---------------

ã“ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¦‹ã¦ã€ç§ã¯ä¸–ä»£é–“ã®ã‚®ãƒ£ãƒƒãƒ—ã«ã¤ã„ã¦ã‚‚è€ƒãˆã¾ã—ãŸã€‚

ä¿è‚²ã®ç¾å ´ã«ã„ãŸæ™‚ã‚‚ã€åŒä¸–ä»£ã®åŒåƒšã¨ã¯ä¾¡å€¤è¦³ãŒåˆã£ã¦ã‚‚ã€ä»–ã®ä¸–ä»£ã®äººã¨ã¯è©±ãŒåˆã„ã«ãã„ã€ã¨æ„Ÿã˜ã‚‹ã“ã¨ãŒã‚ˆãã‚ã‚Šã¾ã—ãŸã€‚

ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã«ãªã£ã¦ä¸€ç•ªè‰¯ã‹ã£ãŸã¨æ„Ÿã˜ã‚‹ã®ã¯ã€ã€Œä¸€ç·’ã«åƒãäººã‚’é¸ã¹ã‚‹ã€ã¨ã„ã†æ„Ÿè¦šã‚’æŒã¦ãŸã“ã¨ã§ã™ã€‚ä»Šã¯ã€åŒã˜ä¾¡å€¤è¦³ã‚’æŒã¤äººãŸã¡ã¨ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã§ç¹‹ãŒã‚Šã€å…±ã«å­¦ã¹ã‚‹åƒãæ–¹ã«ã¨ã¦ã‚‚æº€è¶³ã—ã¦ã„ã¾ã™ã€‚

ãŸã ã€ä»Šå¾Œã®ã“ã¨ã‚’è€ƒãˆã‚‹ã¨ã€ä¾¡å€¤è¦³ã®åˆã†äººã¨ã ã‘ã§ã¯ãªãã€æ§˜ã€…ãªç«‹å ´ã®äººãŸã¡ã¨å”åŠ›ã—ã¦ã„ãå¿…è¦ã‚‚ã‚ã‚Šã¾ã™ã‚ˆã­ã€‚

---------------

AIã«é™ã‚‰ãšã€ã©ã‚“ãªã“ã¨ã§ã‚‚ã€Œé£Ÿã‚ãšå«Œã„ã€ã¯ã‚‚ã£ãŸã„ãªã„ãªã€ã¨æ€ã„ã¾ã™ã€‚ã¾ãšã¯ä½•ã§ã‚‚è©¦ã—ã¦ã¿ã¦ã€ã€Œè‡ªåˆ†ã«ã¯åˆã†ã‹ã€ã€Œä»Šã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ä½¿ãˆã‚‹ã‹ã€ã‚’åˆ¤æ–­ã™ã‚‹ã€‚

æ–°ã—ã„ã‚‚ã®ã«è§¦ã‚Œã€çŸ¥ã‚‹ã“ã¨ã§ã€åƒãæ–¹ã‚„ç”Ÿãæ–¹ã®é¸æŠè‚¢ã¯ç¢ºå®Ÿã«å¢—ãˆã¦ã„ãã¨æ€ã†ã‚“ã§ã™ã‚ˆã­ã€‚

ã“ã‚Œã‹ã‚‰ã¯ã€AIã‚’å˜ãªã‚‹æ¥­å‹™åŠ¹ç‡åŒ–ã®ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ã ã‘ã§ãªãã€æ™‚ã«ã¯ä¸–ä»£é–“ã®ã‚®ãƒ£ãƒƒãƒ—ã‚’åŸ‹ã‚ã‚‹ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦æ´»ç”¨ã—ã¦ã„ãã€‚ãã‚“ãªè¦–ç‚¹ã‚‚å¿…è¦ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã­ã€‚"""
        }

    def get_transcript_from_input(self) -> str:
        """æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’ç›´æ¥å…¥åŠ›ã§å–å¾—"""
        print("ğŸ“ æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„")
        print("   (è²¼ã‚Šä»˜ã‘å¾Œã€ç©ºè¡Œã§Enterã‚’2å›æŠ¼ã™ã¨å‡¦ç†é–‹å§‹)")
        print("   (ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã™ã‚‹ã«ã¯ 'q' ã‚’å…¥åŠ›)")
        print("-" * 50)
        
        lines = []
        empty_line_count = 0
        
        while True:
            try:
                line = input()
                
                if line.strip().lower() == 'q':
                    return None
                
                if line.strip() == '':
                    empty_line_count += 1
                    if empty_line_count >= 2:  # ç©ºè¡ŒãŒ2å›é€£ç¶šã§å…¥åŠ›çµ‚äº†
                        break
                else:
                    empty_line_count = 0
                
                lines.append(line)
                
            except KeyboardInterrupt:
                print("\nâŒ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã•ã‚Œã¾ã—ãŸ")
                return None
            except EOFError:
                break
        
        transcript = '\n'.join(lines).strip()
        
        if not transcript:
            print("âŒ æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆãŒå…¥åŠ›ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ")
            return None
        
        print(f"\nğŸ“– æ–‡å­—èµ·ã“ã—å–å¾—å®Œäº†: {len(transcript)}æ–‡å­—")
        return transcript

    def clean_transcript(self, transcript: str) -> str:
        """æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã®å¤§å¹…ä¿®æ­£"""
        text = transcript.strip()
        
        # ã‚ˆã‚ŠåŒ…æ‹¬çš„ãªä¿®æ­£ãƒ‘ã‚¿ãƒ¼ãƒ³
        corrections = {
            'ã¾ãªã¿': 'ãƒãƒŠãƒŸ', 'ãƒãƒŠã¿': 'ãƒãƒŠãƒŸ', 'å­¦ã¿': 'ãƒãƒŠãƒŸ',
            'ã•ã‚ã«ã®å­ã ã¾': '3äººã®å­ã©ã‚‚', 'ã‚µãƒ‹ãƒ¼ã®å­ã©ã‚‚': '3äººã®å­ã©ã‚‚', 'ã•ã‚‰ã«ã®å­ã©ã‚‚': '3äººã®å­ã©ã‚‚',
            'SNSã¯ã—ã‚“': 'SNSç™ºä¿¡', 'SNSç™ºä¿¡ã‚„': 'SNSç™ºä¿¡',
            'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒšãƒ¼ã‚µã‚³': 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ', 'ã‚³ãƒ³ãƒ†ãƒ³ãƒãƒ¥ãƒ¼ã‚µã‚³ãƒ¼ãƒãƒ¥ãƒ¼': 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ä½œæˆ',
            'ã¾ã¾ãƒ—ãƒª': 'ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹', 'ã¾ã¾ãƒ—ãƒ¼ãƒ«': 'ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹', 'ã¾ã¾ãƒ•ãƒªãƒ¼ãƒ©ã‚¹': 'ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹',
            'ãƒ•ã‚©ã‚¢ãƒ³': 'ä¸å®‰', 'ãƒ•ãƒ™ãƒ³ã‚µ': 'ä¸ä¾¿ã•',
            'é™ä»£æ§‹': 'å®¶äº‹ä»£è¡Œ', 'ä¾¡å€¤å¤§æ ¹': 'å®¶äº‹ä»£è¡Œ', 'å§‹å¤§å…¬': 'å®¶äº‹ä»£è¡Œ', 'å®¶è‡ªå¤§å…¬': 'å®¶äº‹ä»£è¡Œ',
            'ãƒ•ã‚¡ãƒŸã‚µãƒ': 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã‚µãƒãƒ¼ãƒˆ',
            'ã‚¨ãƒ³ãƒã‚ªãƒ‹ãƒ£': 'é æ–¹', 'ã‚ã•ãªã“ã„ã‚„': 'é æ–¹',
            'ãƒ›ã‚¤ã‚¯ã‚¨ãƒ³ãƒˆ': 'ä¿è‚²åœ’', 'ãã†ã’ãˆ': 'é€è¿',
            'è‡ªè‡ªå¼¾å®¶': 'æ™‚çŸ­å®¶é›»', 'è‡ªå˜å®¶é›»': 'æ™‚çŸ­å®¶é›»',
            'PDCAã§å›ã—ã¦': 'PDCAã‚µã‚¤ã‚¯ãƒ«ã§æ”¹å–„ã—ã¦',
            'ãƒã‚³ãƒ¼ã‚¸': 'ç”ºç”°å¸‚', 'ã¸ã­ãƒ–ãƒƒã‚¿ã‚ªãƒ¬ãƒ«': 'ç™ºç†±',
            'ã‚¤ãƒ³ãƒ•ãƒ¬ãƒ³ã‚¸ãƒ£ãƒ¼': 'ã‚¤ãƒ³ãƒ•ãƒ«ã‚¨ãƒ³ã‚¶',
            'ä»•æœ«': 'é€±æœ«', 'ã©ã«ã¡': 'åœŸæ—¥',
            'ãƒªã‚­ãƒ¼ãƒ«': 'è§£æ±º', 'ãƒ‡ãƒ™ã‚¹ãƒˆ': 'ãƒ™ã‚¹ãƒˆ',
            'ã‚¹ã‚¤ãƒƒãƒãƒœãƒ¼ãƒˆ': 'ã‚¹ã‚¤ãƒƒãƒãƒœãƒƒãƒˆ', 'æ°´ä¸€ãƒœãƒ¼ãƒˆ': 'ã‚¹ã‚¤ãƒƒãƒãƒœãƒƒãƒˆ'
        }
        
        for old, new in corrections.items():
            text = text.replace(old, new)
        
        # ãƒ•ã‚£ãƒ©ãƒ¼èªã¨ä¸è¦ãªè¡¨ç¾ã‚’é™¤å»
        fillers = [
            r'ã¯ã„ã“ã‚“ã«ã¡ã¯[^\ã€‚]*?ã§ã™',
            r'ãˆãƒ¼+ã€?', r'ã‚ã®+ã€?', r'ãˆã£ã¨+ã€?', r'ã†ãƒ¼ã‚“+ã€?', r'ã¾ã+ã€?',
            r'ãªã‚“ã‹+ã€?', r'ã¡ã‚‡ã£ã¨+ã€?', r'ã§ã‚‚+ã€?', r'ãã†+ã€?',
            r'ã£ã¦ã„ã†+ãµã†+ã«', r'ã¿ãŸã„ãª+æ„Ÿã˜', r'ã£ã¦+ã„ã†+ã®+ã¯',
            r'ã ã¨+æ€ã†+ã‚“+ã§ã™+ã‘ã©', r'ãªã‚“+ã§ã™+ã‚ˆ+ã­',
            r'ã£ã¦+ã„ã†+ã“ã¨+ã§', r'ãã†+ã„ã†+ã“ã¨+ã§',
            r'ã§+ã§+ã§+', r'ã¨+ã¨+ã¨+', r'ã‚“+ã‚“+ã‚“+',
            r'ã£ã¦+ã£ã¦+', r'ã +ã +ã +', r'ã†+ã†+ã†+'
        ]
        
        for filler in fillers:
            text = re.sub(filler, ' ', text)
        
        # å¥èª­ç‚¹ã‚’æ­£è¦åŒ–
        text = re.sub(r'[ã€,]+', 'ã€', text)
        text = re.sub(r'[ã€‚\.]+', 'ã€‚', text)
        text = re.sub(r'\s+', ' ', text)
        
        return text.strip()

    def extract_key_themes(self, clean_text: str) -> dict:
        """éŸ³å£°ã‹ã‚‰ä¸»è¦ãƒ†ãƒ¼ãƒã‚’æŠ½å‡º"""
        
        # ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰åˆ†æï¼ˆå®Ÿéš›ã®noteè¨˜äº‹ã®ãƒ†ãƒ¼ãƒã«åŸºã¥ãï¼‰
        themes = {
            'work': ['ä»•äº‹', 'ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹', 'ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ', 'åƒãæ–¹', 'åœ¨å®…', 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³', 'PRæ¡ˆä»¶', 'ãƒ¡ãƒ¼ãƒ«', 'ã‚„ã‚Šå–ã‚Š', 'ã‚µãƒ¼ãƒ“ã‚¹', 'ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—', 'ä¾¡æ ¼', 'å˜ä¾¡'],
            'technology': ['AI', 'ç”ŸæˆAI', 'ChatGPT', 'ãƒ„ãƒ¼ãƒ«', 'ã‚·ã‚¹ãƒ†ãƒ ', 'ã‚¢ãƒ—ãƒª', 'ãƒ‡ã‚¸ã‚¿ãƒ«', 'ã‚ªãƒ³ãƒ©ã‚¤ãƒ³', 'ãƒªãƒ¢ãƒ¼ãƒˆ'],
            'lifestyle': ['ç”Ÿæ´»', 'æ—¥å¸¸', 'å·¥å¤«', 'æ”¹å–„', 'æ™‚é–“', 'å®¶æ—', 'å­ã©ã‚‚', 'å¤«', 'è‚²å…', 'å®¶äº‹', 'ä¿è‚²åœ’', 'é€è¿', 'ç†±', 'ä½“èª¿', 'ä¿è‚²'],
            'childcare': ['å­è‚²ã¦', 'ä¿è‚²åœ’', 'ãƒ•ã‚¡ãƒŸãƒªãƒ¼ã‚µãƒãƒ¼ãƒˆ', 'å­ã©ã‚‚', 'è‚²å…', '3äºº', '0æ­³', 'é€è¿', 'è‡ªå®…ä¿è‚²', 'ãƒ¯ãƒ³ã‚ªãƒš'],
            'money': ['ãŠé‡‘', 'ä¾¡æ ¼', 'å˜ä¾¡', 'æ–™é‡‘', 'è²»ç”¨', 'å£²ä¸Š', 'åå…¥', 'å®¶è¨ˆ', 'å€¤æ®µ', 'ã‚³ã‚¹ãƒˆ'],
            'communication': ['ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³', 'ä¼ãˆã‚‹', 'ç›¸è«‡', 'è©±ã—åˆã„', 'ã‚„ã‚Šå–ã‚Š', 'ãƒ¡ãƒ¼ãƒ«', 'é€£çµ¡', 'ä¼šè©±', 'èª¬æ˜']
        }
        
        detected_themes = {}
        for theme, keywords in themes.items():
            count = sum(1 for keyword in keywords if keyword in clean_text)
            if count > 0:
                detected_themes[theme] = count
        
        # æœ€ã‚‚å¤šãè¨€åŠã•ã‚ŒãŸãƒ†ãƒ¼ãƒã‚’ç‰¹å®š
        main_theme = max(detected_themes.items(), key=lambda x: x[1])[0] if detected_themes else 'lifestyle'
        
        return {'main_theme': main_theme, 'all_themes': detected_themes}

    def extract_meaningful_sentences(self, clean_text: str) -> list:
        """æ„å‘³ã®ã‚ã‚‹æ–‡ã‚’æŠ½å‡º"""
        
        # æ–‡ã‚’åˆ†å‰²
        sentences = re.split(r'[ã€‚ï¼ï¼Ÿ]', clean_text)
        meaningful = []
        
        for sentence in sentences:
            sentence = sentence.strip()
            
            # æœ€å°æ–‡å­—æ•°ã¨å†…å®¹ãƒã‚§ãƒƒã‚¯
            if len(sentence) < 15:
                continue
                
            # æ„å‘³ã®ãªã„æ–‡ã‚’ã‚¹ã‚­ãƒƒãƒ—
            skip_patterns = [
                r'^[ã¯ã„ã€ãã†ã€ã§ã‚‚ã€ã¾ã‚]+$',
                r'^[ã‚ã®ãˆãƒ¼ã£ã¨\s]+$',
                r'ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã—ãŸ$'
            ]
            
            if any(re.search(pattern, sentence) for pattern in skip_patterns):
                continue
            
            # æ–‡ã¨ã—ã¦æˆç«‹ã—ã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
            if any(word in sentence for word in ['ã§ã™', 'ã¾ã™', 'ã—ãŸ', 'ã‚ã‚‹', 'ã„ã‚‹', 'ãªã‚‹']):
                meaningful.append(sentence + 'ã€‚')
        
        return meaningful[:12]  # æœ€å¤§12æ–‡

    def analyze_writing_style(self, sample_text: str) -> dict:
        """æ–‡ä½“ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’åˆ†æ"""
        style_patterns = {
            'intro_pattern': r'ãƒãƒŠãƒŸã§ã™ã€‚\n\nä»Šå›ã¯(.+?)ã«ã¤ã„ã¦',
            'section_separator': r'---------------',
            'conclusion_pattern': r'çš†ã•ã‚“(ã‚‚|ã«ã‚‚)(.+?)ã¨æ€ã„ã¾ã™ã€‚',
            'personal_touch': ['3äººã®å­ã©ã‚‚', 'ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹', 'ç§ã¯', 'æˆ‘ãŒå®¶'],
            'polite_ending': ['ã¨æ€ã„ã¾ã™', 'ã§ã—ã‚‡ã†ã‹', 'ã§ã¯ãªã„ã‹ã¨']
        }
        
        return style_patterns

    def create_article_sections(self, sentences: list, theme: str) -> list:
        """ãƒ†ãƒ¼ãƒã«å¿œã˜ãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ"""
        
        if not sentences:
            return self.create_fallback_sections(theme)
        
        sections = []
        
        # ãƒ†ãƒ¼ãƒåˆ¥ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³æ§‹æˆ
        if theme == 'products':
            sections = self.create_product_review_sections(sentences)
        elif theme == 'housework':
            sections = self.create_housework_sections(sentences)
        elif theme == 'work':
            sections = self.create_work_sections(sentences)
        elif theme == 'childcare':
            sections = self.create_childcare_sections(sentences)
        else:
            sections = self.create_general_sections(sentences)
        
        return sections

    def create_product_review_sections(self, sentences: list) -> list:
        """å•†å“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        sections = []
        
        section1 = f"""{' '.join(sentences[:4])}

å•†å“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ä½œæˆã™ã‚‹éš›ã¯ã€å®Ÿéš›ã®ä½“é¨“ã¨æ„Ÿã˜ãŸã“ã¨ã‚’æ­£ç›´ã«ãŠä¼ãˆã™ã‚‹ã“ã¨ã‚’å¿ƒãŒã‘ã¦ã„ã¾ã™ã€‚ä½¿ã£ã¦ã¿ã¦è‰¯ã‹ã£ãŸç‚¹ã ã‘ã§ãªãã€æ°—ã«ãªã£ãŸç‚¹ãŒã‚ã‚Œã°åˆã‚ã›ã¦ã”ç´¹ä»‹ã™ã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚"""
        
        section2 = f"""{' '.join(sentences[4:8]) if len(sentences) > 4 else 'å®Ÿéš›ã«ä½¿ç”¨ã—ã¦ã¿ãŸæ„Ÿæƒ³ã‚„ã€æ—¥å¸¸ç”Ÿæ´»ã§ã®æ´»ç”¨æ–¹æ³•ã«ã¤ã„ã¦ãŠè©±ã—ã—ã¾ã™ã€‚'}

å•†å“ã‚’ä½¿ã†å‰ã¨å¾Œã§ã®å¤‰åŒ–ã‚„ã€å®¶æ—ã®åå¿œãªã©ã‚‚å«ã‚ã¦ã€ãƒªã‚¢ãƒ«ãªä½¿ç”¨æ„Ÿã‚’ãŠä¼ãˆã§ãã‚Œã°ã¨æ€ã„ã¾ã™ã€‚åŒã˜ã‚ˆã†ãªå•†å“ã‚’æ¤œè¨ã—ã¦ã„ã‚‹æ–¹ã®å‚è€ƒã«ãªã‚Œã°å¬‰ã—ã„ã§ã™ã€‚"""
        
        section3 = f"""{' '.join(sentences[8:]) if len(sentences) > 8 else 'ä»Šå¾Œã‚‚ã“ã†ã—ãŸå•†å“ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’é€šã—ã¦ã€çš†ã•ã‚“ã®æ—¥å¸¸ç”Ÿæ´»ã«å½¹ç«‹ã¤æƒ…å ±ã‚’ãŠå±Šã‘ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚'}

å•†å“é¸ã³ã®å‚è€ƒã«ãªã‚‹ã‚ˆã†ãªæƒ…å ±æä¾›ã‚’å¿ƒãŒã‘ãªãŒã‚‰ã€ä»Šå¾Œã‚‚æ§˜ã€…ãªå•†å“ã‚’è©¦ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚"""
        
        return [section1, section2, section3]

    def create_housework_sections(self, sentences: list) -> list:
        """å®¶äº‹ãƒ†ãƒ¼ãƒã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        sections = []
        
        section1 = f"""{' '.join(sentences[:4])}

3äººã®å­ã©ã‚‚ãŒã„ã‚‹æˆ‘ãŒå®¶ã§ã¯ã€æ¯æ—¥ã®å®¶äº‹ãŒå¤§å¤‰ãªä½œæ¥­ã®ä¸€ã¤ã§ã™ã€‚åŠ¹ç‡åŒ–ã‚„å¤–éƒ¨ã‚µãƒ¼ãƒ“ã‚¹ã®åˆ©ç”¨ãªã©ã€æ§˜ã€…ãªé¸æŠè‚¢ãŒã‚ã‚‹ä¸­ã§ã€è‡ªåˆ†ãªã‚Šã®æ–¹æ³•ã‚’æ¨¡ç´¢ã—ã¦ã„ã¾ã™ã€‚"""
        
        section2 = f"""{' '.join(sentences[4:8]) if len(sentences) > 4 else 'æ—¥ã€…è©¦è¡ŒéŒ¯èª¤ã—ãªãŒã‚‰ã€å®¶æ—ã«ã¨ã£ã¦æœ€é©ãªæ–¹æ³•ã‚’è¦‹ã¤ã‘ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚'}

å®¶äº‹ã¯å˜ãªã‚‹ä½œæ¥­ã§ã¯ãªãã€å®¶æ—ã®ç”Ÿæ´»ã®è³ªã«ç›´çµã™ã‚‹é‡è¦ãªè¦ç´ ã ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚ãã®ãŸã‚ã€åŠ¹ç‡ã ã‘ã§ãªãã€å®¶æ—ã¿ã‚“ãªãŒå¿«é©ã«éã”ã›ã‚‹ã“ã¨ã‚’é‡è¦–ã—ã¦ã„ã¾ã™ã€‚"""
        
        section3 = f"""{' '.join(sentences[8:]) if len(sentences) > 8 else 'ä»Šå¾Œã‚‚å®¶æ—ã®æˆé•·ã‚„å¤‰åŒ–ã«åˆã‚ã›ã¦ã€æŸ”è»Ÿã«å®¶äº‹ã®ã‚„ã‚Šæ–¹ã‚’èª¿æ•´ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚'}

å®Œç’§ã‚’æ±‚ã‚ã™ããšã€å®¶æ—ã¿ã‚“ãªãŒå”åŠ›ã—ãªãŒã‚‰ã€ç„¡ç†ã®ãªã„ç¯„å›²ã§å®¶äº‹ã‚’åˆ†æ‹…ã—ã¦ã„ãã“ã¨ãŒå¤§åˆ‡ã ã¨æ„Ÿã˜ã¦ã„ã¾ã™ã€‚"""
        
        return [section1, section2, section3]

    def create_work_sections(self, sentences: list) -> list:
        """ä»•äº‹ãƒ†ãƒ¼ãƒã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        sections = []
        
        section1 = f"""{' '.join(sentences[:4])}

ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦åƒãä¸­ã§ã€å­è‚²ã¦ã¨ä»•äº‹ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚‹ã“ã¨ã¯æ—¥ã€…ã®å¤§ããªèª²é¡Œã§ã™ã€‚æŸ”è»Ÿãªåƒãæ–¹ãŒã§ãã‚‹åé¢ã€æ™‚é–“ç®¡ç†ã‚„é›†ä¸­ã§ãã‚‹ç’°å¢ƒä½œã‚ŠãŒé‡è¦ã«ãªã£ã¦ãã¾ã™ã€‚"""
        
        section2 = f"""{' '.join(sentences[4:8]) if len(sentences) > 4 else 'åœ¨å®…ãƒ¯ãƒ¼ã‚¯ã®ãƒ¡ãƒªãƒƒãƒˆã‚’æ´»ã‹ã—ãªãŒã‚‰ã€åŠ¹ç‡çš„ã«ä»•äº‹ã‚’é€²ã‚ã‚‹æ–¹æ³•ã‚’æ¨¡ç´¢ã—ã¦ã„ã¾ã™ã€‚'}

ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ¯ãƒ¼ã‚¯ã§ã¯ã€äº‹å‰ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å¤§åˆ‡ã«ã—ã¦ã€ãŠäº’ã„ã®æœŸå¾…å€¤ã‚’æ˜ç¢ºã«ã™ã‚‹ã“ã¨ã‚’å¿ƒãŒã‘ã¦ã„ã¾ã™ã€‚"""
        
        section3 = f"""{' '.join(sentences[8:]) if len(sentences) > 8 else 'å®¶æ—ã®çŠ¶æ³ã«åˆã‚ã›ã¦åƒãæ–¹ã‚’èª¿æ•´ã—ãªãŒã‚‰ã€é•·æœŸçš„ãªã‚­ãƒ£ãƒªã‚¢å½¢æˆã‚‚è¦–é‡ã«å…¥ã‚Œã¦ã„ã¾ã™ã€‚'}

ãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã„ã†åƒãæ–¹ã‚’é€šã˜ã¦ã€å¤šãã®çµŒé¨“ã‚’ç©ã¿ãªãŒã‚‰æˆé•·ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚"""
        
        return [section1, section2, section3]

    def create_childcare_sections(self, sentences: list) -> list:
        """å­è‚²ã¦ãƒ†ãƒ¼ãƒã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        sections = []
        
        section1 = f"""{' '.join(sentences[:4])}

3äººã®å­ã©ã‚‚ã‚’è‚²ã¦ã‚‹ä¸­ã§ã€æ¯æ—¥ãŒè©¦è¡ŒéŒ¯èª¤ã®é€£ç¶šã§ã™ã€‚å­ã©ã‚‚ã®æˆé•·ã«åˆã‚ã›ã¦å¯¾å¿œã‚’å¤‰ãˆã¦ã„ãå¿…è¦ãŒã‚ã‚Šã€ãã®éƒ½åº¦æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚Šã¾ã™ã€‚"""
        
        section2 = f"""{' '.join(sentences[4:8]) if len(sentences) > 4 else 'å­ã©ã‚‚ãŸã¡ã¨ã®æ™‚é–“ã‚’å¤§åˆ‡ã«ã—ãªãŒã‚‰ã€ãã‚Œãã‚Œã®å€‹æ€§ã«åˆã‚ã›ãŸé–¢ã‚ã‚Šæ–¹ã‚’å¿ƒãŒã‘ã¦ã„ã¾ã™ã€‚'}

å­è‚²ã¦ã«æ­£è§£ã¯ãªã„ã¨æ€ã„ã¾ã™ãŒã€å­ã©ã‚‚ãŸã¡ã¨ä¸€ç·’ã«æˆé•·ã—ã¦ã„ãéç¨‹ã‚’æ¥½ã—ã¿ãªãŒã‚‰éã”ã—ã¦ã„ã¾ã™ã€‚"""
        
        section3 = f"""{' '.join(sentences[8:]) if len(sentences) > 8 else 'å­ã©ã‚‚ãŸã¡ã®æˆé•·ã«åˆã‚ã›ã¦ã€è¦ªã¨ã—ã¦ã‚‚æˆé•·ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚'}

å­ã©ã‚‚ãŸã¡ãŒè‡ªåˆ†ã‚‰ã—ãè‚²ã£ã¦ã„ã‘ã‚‹ã‚ˆã†ã€ã‚µãƒãƒ¼ãƒˆã—ãªãŒã‚‰è¦‹å®ˆã£ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚"""
        
        return [section1, section2, section3]

    def create_general_sections(self, sentences: list) -> list:
        """ä¸€èˆ¬çš„ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        sections = []
        
        third = len(sentences) // 3
        
        section1 = f"""{' '.join(sentences[:third]) if sentences else 'æ—¥å¸¸ç”Ÿæ´»ã®ä¸­ã§æ°—ã¥ã„ãŸã“ã¨ã‚„æ„Ÿã˜ãŸã“ã¨ã‚’çš†ã•ã‚“ã¨å…±æœ‰ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚'}

æ¯æ—¥ã®ç”Ÿæ´»ã®ä¸­ã«ã¯ã€å°ã•ãªç™ºè¦‹ã‚„å­¦ã³ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ãã†ã—ãŸæ°—ã¥ãã‚’å¤§åˆ‡ã«ã—ãªãŒã‚‰éã”ã—ã¦ã„ã¾ã™ã€‚"""
        
        section2 = f"""{' '.join(sentences[third:2*third]) if len(sentences) > third else 'æ§˜ã€…ãªå ´é¢ã§å­¦ã‚“ã ã“ã¨ã‚„æ„Ÿã˜ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚'}

å®Ÿéš›ã«çµŒé¨“ã—ã¦ã¿ã‚‹ã“ã¨ã§åˆã‚ã¦åˆ†ã‹ã‚‹ã“ã¨ã‚‚å¤šãã€æŒ‘æˆ¦ã™ã‚‹ã“ã¨ã®å¤§åˆ‡ã•ã‚’å®Ÿæ„Ÿã—ã¦ã„ã¾ã™ã€‚"""
        
        section3 = f"""{' '.join(sentences[2*third:]) if len(sentences) > 2*third else 'ä»Šå¾Œã‚‚æ–°ã—ã„æŒ‘æˆ¦ã‚’ç¶šã‘ãªãŒã‚‰æˆé•·ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚'}

ã“ã‚Œã‹ã‚‰ã‚‚çš†ã•ã‚“ã¨ä¸€ç·’ã«å­¦ã³åˆã„ãªãŒã‚‰ã€ã‚ˆã‚Šè‰¯ã„æ—¥ã€…ã‚’éã”ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚"""
        
        return [section1, section2, section3]

    def create_fallback_sections(self, theme: str) -> list:
        """ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ç”¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³"""
        return [
            "æœ€è¿‘ã®ç”Ÿæ´»ã®ä¸­ã§æ„Ÿã˜ã¦ã„ã‚‹ã“ã¨ã«ã¤ã„ã¦ãŠè©±ã—ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚æ—¥ã€…ã®æš®ã‚‰ã—ã®ä¸­ã«ã¯å¤šãã®å­¦ã³ãŒã‚ã‚Šã€ãã‚Œã‚‰ã‚’çš†ã•ã‚“ã¨å…±æœ‰ã§ãã‚Œã°ã¨æ€ã„ã¾ã™ã€‚",
            "å…·ä½“çš„ãªä½“é¨“ã‚’é€šã—ã¦å­¦ã‚“ã ã“ã¨ãŒãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚å°ã•ãªã“ã¨ã§ã‚‚ã€å®Ÿéš›ã«ã‚„ã£ã¦ã¿ã‚‹ã“ã¨ã§æ–°ã—ã„ç™ºè¦‹ãŒã‚ã‚‹ã“ã¨ãŒå¤šã„ã§ã™ã€‚",
            "ä»Šå¾Œã‚‚ã“ã†ã—ãŸæ—¥ã€…ã®æ°—ã¥ãã‚’å¤§åˆ‡ã«ã—ãªãŒã‚‰ã€çš†ã•ã‚“ã¨å…±æœ‰ã—ã¦ã„ããŸã„ã¨æ€ã„ã¾ã™ã€‚ä¸€ç·’ã«å­¦ã³åˆã„ãªãŒã‚‰æˆé•·ã—ã¦ã„ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚"
        ]

    def generate_article(self, transcript: str) -> str:
        """è¨˜äº‹ç”Ÿæˆãƒ¡ã‚¤ãƒ³"""
        print("ğŸ”§ æ–‡å­—èµ·ã“ã—ã‚’ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ä¸­...")
        
        # æ–‡å­—èµ·ã“ã—ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°
        clean_text = self.clean_transcript(transcript)
        
        # ãƒ†ãƒ¼ãƒåˆ†æ
        theme_data = self.extract_key_themes(clean_text)
        main_theme = theme_data['main_theme']
        
        print(f"ğŸ“ æ¤œå‡ºã•ã‚ŒãŸãƒ†ãƒ¼ãƒ: {main_theme}")
        
        # æ„å‘³ã®ã‚ã‚‹æ–‡ã‚’æŠ½å‡º
        meaningful_sentences = self.extract_meaningful_sentences(clean_text)
        print(f"ğŸ“„ æŠ½å‡ºã•ã‚ŒãŸæ–‡: {len(meaningful_sentences)}å€‹")
        
        # ã‚»ã‚¯ã‚·ãƒ§ãƒ³ä½œæˆ
        sections = self.create_article_sections(meaningful_sentences, main_theme)
        
        # ãƒ†ãƒ¼ãƒã«å¿œã˜ãŸã‚¿ã‚¤ãƒˆãƒ«ã¨å°å…¥
        theme_titles = {
            'work': 'åƒãæ–¹ã«ã¤ã„ã¦è€ƒãˆã¦ã„ã‚‹ã“ã¨',
            'technology': 'AIã‚„ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã«ã¤ã„ã¦æ€ã†ã“ã¨', 
            'childcare': 'å­è‚²ã¦ã«ã¤ã„ã¦æ„Ÿã˜ã‚‹ã“ã¨',
            'lifestyle': 'æœ€è¿‘ã®ç”Ÿæ´»ã«ã¤ã„ã¦',
            'money': 'ãŠé‡‘ã«ã¤ã„ã¦è€ƒãˆã¦ã„ã‚‹ã“ã¨',
            'communication': 'ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã¤ã„ã¦æ€ã†ã“ã¨'
        }
        
        title = theme_titles.get(main_theme, 'æœ€è¿‘è€ƒãˆã¦ã„ã‚‹ã“ã¨')
        
        # è¨˜äº‹æ§‹æˆ
        intro = f"""ãƒãƒŠãƒŸã§ã™ã€‚

ä»Šå›ã¯{title}ã«ã¤ã„ã¦ãŠè©±ã—ã—ãŸã„ã¨æ€ã„ã¾ã™ã€‚

3äººã®å­ã©ã‚‚ã‚’è‚²ã¦ãªãŒã‚‰ãƒãƒãƒ•ãƒªãƒ¼ãƒ©ãƒ³ã‚¹ã¨ã—ã¦åƒã„ã¦ã„ã‚‹ä¸­ã§ã€æ—¥ã€…æ§˜ã€…ãªã“ã¨ã‚’è€ƒãˆãŸã‚Šä½“é¨“ã—ãŸã‚Šã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã¯ã€ãã®ä¸­ã§ã‚‚ç‰¹ã«çš†ã•ã‚“ã¨å…±æœ‰ã—ãŸã„ã¨æ€ã£ãŸå†…å®¹ã«ã¤ã„ã¦ãŠè©±ã—ã—ã¾ã™ã€‚

åŒã˜ã‚ˆã†ãªç«‹å ´ã®æ–¹ã‚„ã€ä¼¼ãŸã‚ˆã†ãªçŠ¶æ³ã«ã‚ã‚‹æ–¹ã®å‚è€ƒã«ãªã‚Œã°å¬‰ã—ã„ã§ã™ã€‚"""
        
        conclusion = f"""ä»Šå›ãŠè©±ã—ã—ãŸå†…å®¹ã¯ã€ç§è‡ªèº«ã®çµŒé¨“ã‚„è€ƒãˆã«åŸºã¥ãã‚‚ã®ã§ã™ãŒã€çš†ã•ã‚“ã®æ—¥å¸¸ç”Ÿæ´»ã«ã‚‚ä½•ã‹ã—ã‚‰ã®ãƒ’ãƒ³ãƒˆã«ãªã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

å­è‚²ã¦ã¨ä»•äº‹ã‚’ä¸¡ç«‹ã—ãªãŒã‚‰ã®æ—¥ã€…ã¯æ±ºã—ã¦æ¥½ã§ã¯ã‚ã‚Šã¾ã›ã‚“ãŒã€ãã®ä¸­ã«ã‚‚å¤šãã®å­¦ã³ã‚„æ°—ã¥ããŒã‚ã‚Šã¾ã™ã€‚ä»Šå¾Œã‚‚ã“ã†ã—ãŸçµŒé¨“ã‚’çš†ã•ã‚“ã¨å…±æœ‰ã—ãªãŒã‚‰ã€ä¸€ç·’ã«æˆé•·ã—ã¦ã„ã‘ã‚Œã°ã¨æ€ã„ã¾ã™ã€‚

çš†ã•ã‚“ã‚‚ãœã²ã€æ—¥å¸¸ã®å°ã•ãªæ°—ã¥ãã‚„å·¥å¤«ã‚’å¤§åˆ‡ã«ã—ã¦ã¿ã¦ãã ã•ã„ã€‚ãã†ã—ãŸç©ã¿é‡ã­ãŒã€ã‚ˆã‚Šè‰¯ã„ç”Ÿæ´»ã«ã¤ãªãŒã£ã¦ã„ãã®ã§ã¯ãªã„ã‹ã¨æ€ã„ã¾ã™ã€‚"""
        
        # è¨˜äº‹çµ„ã¿ç«‹ã¦
        article = f"{intro}\n\n---------------\n\n{sections[0]}\n\n---------------\n\n{sections[1]}\n\n---------------\n\n{sections[2]}\n\n---------------\n\n{conclusion}"
        
        return article

    def copy_to_clipboard(self, text: str):
        """ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼"""
        try:
            pyperclip.copy(text)
            print("ğŸ“‹ è¨˜äº‹ã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼")
        except Exception as e:
            print(f"âš ï¸ ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã‚³ãƒ”ãƒ¼å¤±æ•—: {e}")

    def save_article(self, article: str, transcript_path: str) -> str:
        """è¨˜äº‹ã‚’ä¿å­˜ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®šæ™‚ï¼‰"""
        # ä¿å­˜ãƒ•ã‚¡ã‚¤ãƒ«åã‚’ç”Ÿæˆ
        transcript_name = Path(transcript_path).stem.replace('transcript_', '')
        article_filename = f"article_{transcript_name}.md"
        article_path = Path("/Users/manami/audio_to_article_new") / article_filename
        
        try:
            with open(article_path, 'w', encoding='utf-8') as f:
                f.write(article)
            
            print(f"ğŸ’¾ è¨˜äº‹ä¿å­˜å®Œäº†: {article_filename}")
            return str(article_path)
            
        except Exception as e:
            print(f"âŒ ä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
            return None

    def save_article_with_timestamp(self, article: str) -> str:
        """è¨˜äº‹ã‚’ä¿å­˜ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãï¼‰"""
        from datetime import datetime
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        article_filename = f"article_{timestamp}.md"
        article_path = Path("/Users/manami/audio_to_article_new") / article_filename
        
        try:
            with open(article_path, 'w', encoding='utf-8') as f:
                f.write(article)
            
            print(f"ğŸ’¾ è¨˜äº‹ä¿å­˜å®Œäº†: {article_filename}")
            return str(article_path)
            
        except Exception as e:
            print(f"âŒ ä¿å­˜ã‚¨ãƒ©ãƒ¼: {e}")
            return None

    def process_transcript_input(self):
        """è²¼ã‚Šä»˜ã‘ã‚‰ã‚ŒãŸæ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’å‡¦ç†ã—ã¦è¨˜äº‹ã‚’ç”Ÿæˆ"""
        
        # æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’å–å¾—
        transcript = self.get_transcript_from_input()
        if not transcript:
            return None
        
        # è¨˜äº‹ç”Ÿæˆ
        print("ğŸ¤– è¨˜äº‹ç”Ÿæˆä¸­...")
        article = self.generate_article(transcript)
        
        # çµæœè¡¨ç¤º
        print("\n" + "=" * 80)
        print("ğŸ“° ç”Ÿæˆã•ã‚ŒãŸè¨˜äº‹:")
        print("=" * 80)
        print(article)
        print("=" * 80)
        
        # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        self.copy_to_clipboard(article)
        
        # è¨˜äº‹ä¿å­˜ï¼ˆã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ä»˜ãï¼‰
        saved_path = self.save_article_with_timestamp(article)
        
        print(f"\nâœ… å‡¦ç†å®Œäº†")
        if saved_path:
            print(f"ğŸ’¾ ä¿å­˜å ´æ‰€: {saved_path}")
        
        return article

    def process_transcript_file(self, transcript_path: str):
        """æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡¦ç†ã—ã¦è¨˜äº‹ã‚’ç”Ÿæˆï¼ˆãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®šæ™‚ï¼‰"""
        print(f"ğŸ” å‡¦ç†é–‹å§‹: {Path(transcript_path).name}")
        
        # æ–‡å­—èµ·ã“ã—èª­ã¿è¾¼ã¿
        try:
            with open(transcript_path, 'r', encoding='utf-8') as f:
                transcript = f.read().strip()
            print(f"ğŸ“– æ–‡å­—èµ·ã“ã—èª­ã¿è¾¼ã¿å®Œäº†: {len(transcript)}æ–‡å­—")
        except Exception as e:
            print(f"âŒ ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
            return None
        
        # è¨˜äº‹ç”Ÿæˆ
        print("ğŸ¤– è¨˜äº‹ç”Ÿæˆä¸­...")
        article = self.generate_article(transcript)
        
        # çµæœè¡¨ç¤º
        print("\n" + "=" * 80)
        print("ğŸ“° ç”Ÿæˆã•ã‚ŒãŸè¨˜äº‹:")
        print("=" * 80)
        print(article)
        print("=" * 80)
        
        # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
        self.copy_to_clipboard(article)
        
        # è¨˜äº‹ä¿å­˜
        saved_path = self.save_article(article, transcript_path)
        
        print(f"\nâœ… å‡¦ç†å®Œäº†")
        if saved_path:
            print(f"ğŸ’¾ ä¿å­˜å ´æ‰€: {saved_path}")
        
        return article

def main():
    parser = argparse.ArgumentParser(description='è¨˜äº‹ç”Ÿæˆå°‚ç”¨ãƒ„ãƒ¼ãƒ«')
    parser.add_argument('transcript_file', nargs='?', help='æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ‘ã‚¹')
    parser.add_argument('--stdin', action='store_true', help='æ¨™æº–å…¥åŠ›ã‹ã‚‰æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿')
    
    args = parser.parse_args()
    
    generator = ArticleGenerator()
    
    # æ¨™æº–å…¥åŠ›ã‹ã‚‰èª­ã¿è¾¼ã¿ï¼ˆãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå¯¾å¿œï¼‰
    if not sys.stdin.isatty() or args.stdin:
        print("ğŸ“ æ¨™æº–å…¥åŠ›ã‹ã‚‰æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’èª­ã¿è¾¼ã¿ä¸­...")
        try:
            transcript = sys.stdin.read().strip()
            if transcript:
                print(f"ğŸ“– æ–‡å­—èµ·ã“ã—å–å¾—å®Œäº†: {len(transcript)}æ–‡å­—")
                print("ğŸ¤– è¨˜äº‹ç”Ÿæˆä¸­...")
                article = generator.generate_article(transcript)
                
                # çµæœè¡¨ç¤º
                print("\n" + "=" * 80)
                print("ğŸ“° ç”Ÿæˆã•ã‚ŒãŸè¨˜äº‹:")
                print("=" * 80)
                print(article)
                print("=" * 80)
                
                # ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼
                generator.copy_to_clipboard(article)
                
                # è¨˜äº‹ä¿å­˜
                saved_path = generator.save_article_with_timestamp(article)
                
                print(f"\nâœ… å‡¦ç†å®Œäº†")
                if saved_path:
                    print(f"ğŸ’¾ ä¿å­˜å ´æ‰€: {saved_path}")
                return
            else:
                print("âŒ æ¨™æº–å…¥åŠ›ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãŒèª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ")
                return
        except Exception as e:
            print(f"âŒ æ¨™æº–å…¥åŠ›èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {e}")
            return
    
    print("ğŸ“" + "=" * 50)
    print("   è¨˜äº‹ç”Ÿæˆå°‚ç”¨ãƒ„ãƒ¼ãƒ«")
    print("   Step 2: æ–‡å­—èµ·ã“ã— â†’ è¨˜äº‹")
    print("=" * 52)
    print()
    
    # ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°ã§æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ãŒæŒ‡å®šã•ã‚Œã¦ã„ã‚‹å ´åˆ
    if args.transcript_file:
        transcript_path = args.transcript_file.strip().strip('"').strip("'")
        transcript_path = os.path.expanduser(transcript_path)
        
        if os.path.exists(transcript_path):
            generator.process_transcript_file(transcript_path)
        else:
            print(f"âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“: {transcript_path}")
        return
    
    # ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ¢ãƒ¼ãƒ‰ï¼ˆæ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆè²¼ã‚Šä»˜ã‘ï¼‰
    while True:
        print("ğŸ¯ ä»¥ä¸‹ã‹ã‚‰é¸æŠã—ã¦ãã ã•ã„:")
        print("   1. æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆã‚’è²¼ã‚Šä»˜ã‘ã¦è¨˜äº‹ç”Ÿæˆ")
        print("   2. æ–‡å­—èµ·ã“ã—ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ã¦è¨˜äº‹ç”Ÿæˆ")
        print("   q. çµ‚äº†")
        
        choice = input("é¸æŠ (1/2/q): ").strip()
        
        if choice.lower() in ['q', 'quit', 'exit']:
            break
        elif choice == '1':
            # æ–‡å­—èµ·ã“ã—ãƒ†ã‚­ã‚¹ãƒˆè²¼ã‚Šä»˜ã‘ãƒ¢ãƒ¼ãƒ‰
            generator.process_transcript_input()
        elif choice == '2':
            # ãƒ•ã‚¡ã‚¤ãƒ«æŒ‡å®šãƒ¢ãƒ¼ãƒ‰
            file_input = input("ğŸ“„ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹: ").strip()
            
            if not file_input:
                continue
            
            # ãƒ‘ã‚¹ã®æ•´ç†
            transcript_path = file_input.strip()
            if transcript_path.startswith('"') and transcript_path.endswith('"'):
                transcript_path = transcript_path[1:-1]
            elif transcript_path.startswith("'") and transcript_path.endswith("'"):
                transcript_path = transcript_path[1:-1]
            
            transcript_path = transcript_path.replace('\\ ', ' ')
            transcript_path = os.path.expanduser(transcript_path)
            
            if os.path.exists(transcript_path):
                generator.process_transcript_file(transcript_path)
            else:
                print("âŒ ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
                continue
        else:
            print("âŒ ç„¡åŠ¹ãªé¸æŠã§ã™")
            continue
        
        # æ¬¡ã®å‡¦ç†ã‚’ç¢ºèª
        print("\n" + "=" * 50)
        next_action = input("ğŸ”„ ç¶šã‘ã¦å‡¦ç†ã—ã¾ã™ã‹ï¼Ÿ (y/N): ").lower().strip()
        if next_action not in ['y', 'yes']:
            break
    
    print("ğŸ‘‹ ãŠç–²ã‚Œã•ã¾ã§ã—ãŸï¼")

if __name__ == "__main__":
    main()