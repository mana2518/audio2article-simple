#!/bin/bash

# éŸ³å£°ã‹ã‚‰è¨˜äº‹åŒ–ãƒ„ãƒ¼ãƒ« - Whisperç‰ˆï¼ˆç„¡æ–™ï¼‰
# ä½¿ç”¨æ–¹æ³•: ./audio2article-simple [éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«]

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
VENV_PATH="$SCRIPT_DIR/venv"
TOOL_PATH="$SCRIPT_DIR/whisper_transcriber.py"

# ä»®æƒ³ç’°å¢ƒã®ç¢ºèª
if [ ! -d "$VENV_PATH" ]; then
    echo "âŒ ä»®æƒ³ç’°å¢ƒãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„:"
    echo "   python3 -m venv venv"
    echo "   source venv/bin/activate"
    echo "   pip install -r requirements-whisper.txt"
    exit 1
fi

# ä»®æƒ³ç’°å¢ƒã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ™ãƒ¼ãƒˆ
source "$VENV_PATH/bin/activate"

# ãƒ„ãƒ¼ãƒ«ã®å®Ÿè¡Œ
TOOL_PATH="$SCRIPT_DIR/integrated_audio_article.py"

if [ "$#" -eq 0 ]; then
    echo "ðŸŽ™ï¸ Audio to Article Generator v5.0 (çµ±åˆç‰ˆ)"
    echo "======================================================"
    echo "âœ¨ éŸ³å£°ã‹ã‚‰è¨˜äº‹ã¾ã§ä¸€æ‹¬å‡¦ç†:"
    echo "  ãƒ» ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ"
    echo "  ãƒ» Whisper base ãƒ¢ãƒ‡ãƒ«ï¼ˆé«˜é€Ÿï¼‰"
    echo "  ãƒ» noteè¨˜äº‹é¢¨ã®é«˜å“è³ªè¨˜äº‹ç”Ÿæˆ"
    echo "  ãƒ» å®Œæˆè¨˜äº‹ã®ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰è‡ªå‹•ã‚³ãƒ”ãƒ¼"
    echo ""
    echo "ä½¿ç”¨æ–¹æ³•:"
    echo "  ./audio2article-simple [éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«]"
    echo "  ã¾ãŸã¯éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—"
    echo ""
    python "$TOOL_PATH" 2>/dev/null
else
    echo "ðŸŽ™ï¸ å‡¦ç†é–‹å§‹: $(basename "$1")"
    echo "ðŸ“Š é€²è¡ŒçŠ¶æ³ã®è©³ç´°è¡¨ç¤ºã‚’æŠ‘åˆ¶ã—ã¦ã„ã¾ã™..."
    echo ""
    python "$TOOL_PATH" "$1" 2>/dev/null
fi